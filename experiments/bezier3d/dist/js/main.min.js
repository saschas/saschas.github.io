function lerp(e,t,i){return(1-i)*e+i*t}function over(e,t){controls.enabled=!1,document.body.style.cursor="move"}function out(e,t){controls.enabled=!0,d.activeElement=null,document.body.style.cursor="auto"}function activeState(e,t){d.activeElement=e}function createSphere(e,t,i,n){2==n&&(e+=2);var r=1==n?16777215:second_color,o=new THREE.Mesh(new THREE.SphereGeometry(e,12,12),new THREE.MeshLambertMaterial({color:r,transparent:!0,opacity:1}));return o.castShadow=!0,o.receiveShadow=!0,o.position.set(t.x,t.y,t.z),o._own={index:i,last:!1},1!=n&&2!=n||(scene.add(o),o._own.last=!0),o}function createSubStep(e){var t=this;this.subStep=[];for(var i=0;i<e.length-1;i++)this.subStep.push(createSphere(1,{x:0,y:0,z:0},i,e.length)),this.subStep[i].update=function(t){var i=lerp(e[this._own.index].position.x,e[this._own.index+1].position.x,t),n=lerp(e[this._own.index].position.y,e[this._own.index+1].position.y,t),r=lerp(e[this._own.index].position.z,e[this._own.index+1].position.z,t);this.position.set(i,n,r)};this.subLineGeometry=new THREE.Geometry,this.subStep.forEach(function(e,i){t.subLineGeometry.vertices.push({x:e.position.x,y:e.position.y,z:e.position.z})}),this.subLine=new THREE.Line(this.subLineGeometry,lineMaterial),scene.add(this.subLine),this.subLine.update=function(){t.subStep.forEach(function(e,t){this.geometry.vertices[t].x=e.position.x,this.geometry.vertices[t].y=e.position.y,this.geometry.vertices[t].z=e.position.z,this.geometry.verticesNeedUpdate=!0}.bind(this))},this.update=function(e){this.subStep.forEach(function(t,i){t.update(e)}),this.subLine.update(e)}}function animation(e){factor=.5+.5*Math.sin(5e-4*e),handlerSpheres.forEach(function(t,i){t.position.x+=.15*Math.sin(25e-5*e*(1+i)),t.position.y+=.15*Math.cos(25e-5*e*(1+i)),t.position.z+=.15*Math.cos(25e-5*e*(1+i)),line.update(t.position,t._own.index)});for(var t=0;100>t;t++)steps.forEach(function(e,i){e.update(.01*t),i==steps.length-1&&(bezier.geometry.vertices[t].x=steps[i].subStep[0].position.x,bezier.geometry.vertices[t].y=steps[i].subStep[0].position.y,bezier.geometry.vertices[t].z=steps[i].subStep[0].position.z)});steps.forEach(function(e,t){e.update(factor)}),bezier.geometry.verticesNeedUpdate=!0}var d={activeElement:null},factor=0,main_color=1942229,second_color=2236962,time=0,canvas_height=window.innerHeight,canvas_width=window.innerWidth,count=10,scene=new THREE.Scene;scene.fog=new THREE.Fog(main_color,700,1e3);var camera=new THREE.PerspectiveCamera(55,canvas_width/canvas_height,.1,5e3);camera.position.set(0,0,450),scene.add(camera);var renderer=new THREE.WebGLRenderer({alpha:!0,antialias:!0});renderer.setSize(canvas_width,canvas_height),renderer.shadowMap.enabled=!0,renderer.shadowMap.type=THREE.PCFSoftShadowMap,renderer.setClearColor(main_color,1),document.body.appendChild(renderer.domElement),Adjust.init({camera:camera,scene:scene,renderer:renderer}),window.onresize=function(){canvas_height=window.innerHeight,canvas_width=window.innerWidth,camera.aspect=canvas_width/canvas_height,camera.updateProjectionMatrix(),renderer.setSize(canvas_width,canvas_height),Adjust.resize()},controls=new THREE.OrbitControls(camera),controls.damping=.2,controls.maxPolarAngle=Math.PI/2,controls.minDistance=300,controls.maxDistance=800;var ambient=new THREE.AmbientLight(6710886);scene.add(ambient);var spotLight=new THREE.SpotLight(16777215);spotLight.position.set(0,250,0),spotLight.angle=Math.PI/3,spotLight.intensity=1,spotLight.castShadow=!0,scene.add(spotLight),spotLight.distance=1500;for(var points=[],p=0;count>p;p++)points.push({x:20*-(count/2)+20*p,y:50*Math.cos(p),z:50*Math.sin(p)});for(var handlerSpheres=[],masterLineGeometry=new THREE.Geometry,lineMaterial=new THREE.LineBasicMaterial({color:16777215,opacity:.3,transparent:!0}),i=0;i<points.length;i++)handlerSpheres[i]=createSphere(5,points[i],i,!0),masterLineGeometry.vertices.push(new THREE.Vector3(points[i].x,points[i].y,points[i].z)),Adjust.addActiveObject(handlerSpheres[i],over,out,activeState,!0);var line=new THREE.Line(masterLineGeometry,lineMaterial);line.update=function(e,t){this.geometry.vertices[t].x=e.x,this.geometry.vertices[t].y=e.y,this.geometry.vertices[t].z=e.z,this.geometry.verticesNeedUpdate=!0},scene.add(line);var plane=new THREE.Mesh(new THREE.CircleGeometry(1500,32),new THREE.MeshStandardMaterial({color:main_color,metalness:.3,roughness:.85,side:THREE.DoubleSide,emissive:2236962}));plane.rotation.x=90*Math.PI/180,plane.position.y=-150,plane.receiveShadow=!0,scene.add(plane);var steps=[];steps[0]=new createSubStep(handlerSpheres);for(var l=1;l<handlerSpheres.length-1;l++)steps[l]=new createSubStep(steps[l-1].subStep);for(var bezierLineMaterial=new THREE.LineBasicMaterial({color:16777215}),bezierGeometry=new THREE.Geometry,p=0;100>p;p++)bezierGeometry.vertices.push(new THREE.Vector3(0,0,0));var bezier=new THREE.Line(bezierGeometry,bezierLineMaterial);bezier.castShadow=!0,bezier.update=function(e,t){this.geometry.vertices[t].x=e.x,this.geometry.vertices[t].y=e.y,this.geometry.vertices[t].z=e.z,this.geometry.verticesNeedUpdate=!0},scene.add(bezier);var render=function(e){requestAnimationFrame(render),controls.update(),Adjust.update(),animation(e),renderer.render(scene,camera)};render(time),document.addEventListener("mousemove",function(e){null!=d.activeElement&&line.update(d.activeElement.position,d.activeElement._own.index)});