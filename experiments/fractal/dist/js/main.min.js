function init(){scene=new THREE.Scene,camera=new THREE.PerspectiveCamera(55,canvas_width/canvas_height,.1,1e3),camera.position.set(0,0,155),scene.add(camera),renderer=new THREE.WebGLRenderer({alpha:!0,antialias:!0}),renderer.setSize(canvas_width,canvas_height),renderer.shadowMap.enabled=!0,renderer.shadowMap.type=THREE.PCFSoftShadowMap,renderer.setClearColor(main_color,1),document.body.appendChild(renderer.domElement);var e=new FractalOptions,a=new dat.GUI,n=a.add(e,"offsetX",-1,1),t=a.add(e,"offsetY",-1,1),o=a.add(e,"zoom",1e-4,2.5),r=a.add(e,"threshold",1e-4,5),i=a.add(e,"facR",1e-4,1),s=a.add(e,"facG",1e-4,1),d=a.add(e,"facB",1e-4,1);n.onChange(function(e){box.material.uniforms.offset.value.x=e}).step(.001),t.onChange(function(e){box.material.uniforms.offset.value.y=e}).step(.001),o.onChange(function(e){box.material.uniforms.zoom.value=e}).step(1e-4),i.onChange(function(e){box.material.uniforms.fac.value.x=e}).step(1e-4),s.onChange(function(e){box.material.uniforms.fac.value.y=e}).step(1e-4),d.onChange(function(e){box.material.uniforms.fac.value.z=e}).step(1e-4),r.onChange(function(e){box.material.uniforms.threshold.value=e}).step(1e-4);var c=document.getElementById("vertex-shader"),f=document.getElementById("fragment-shader"),h=new THREE.ShaderMaterial({vertexShader:c.textContent,fragmentShader:f.textContent,uniforms:{time:{type:"f",value:time},zoom:{type:"f",value:e.zoom},threshold:{type:"f",value:e.threshold},max:{type:"i",value:50},offset:{type:"v2",value:{x:e.offsetX,y:e.offsetY}},fac:{type:"v3",value:{x:e.facR,y:e.facG,z:e.facB}}}});box=new THREE.Mesh(new THREE.PlaneBufferGeometry(100,100,256,256),h),scene.add(box),controls=new THREE.OrbitControls(camera),window.onresize=function(){canvas_height=window.innerHeight,canvas_width=window.innerWidth,camera.aspect=canvas_width/canvas_height,camera.updateProjectionMatrix(),renderer.setSize(canvas_width,canvas_height)},render(time)}function animation(e){clock.getDelta(),box.material.uniforms.time.value=e/1e3}var main_color=0,time=0,canvas_height=window.innerHeight,canvas_width=window.innerWidth,clock=new THREE.Clock,assets={geometry:{},textures:{},materials:{}},scene,camera,renderer,controls,box,FractalOptions=function(){this.offsetX=0,this.offsetY=0,this.threshold=5,this.zoom=1.5,this.facR=.045,this.facG=.005,this.facB=5e-4},render=function(e){requestAnimationFrame(render),controls.update(),animation(e),renderer.render(scene,camera)};init();