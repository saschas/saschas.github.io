function init(){container=document.getElementById("container"),camera=new THREE.PerspectiveCamera(30,SCREEN_WIDTH/SCREEN_HEIGHT,.1,1e4),camera.position.x=100,camera.position.y=50,camera.position.z=400,camera.move_direction=1,scene=new THREE.Scene,scene.fog=new THREE.FogExp2(0,.0015),scene.add(camera),eye_driver=new THREE.Object3D,eye_driver.position.set(0,0,0),scene.add(eye_driver);var e=new THREE.CylinderGeometry(23,23,23,32),r=new THREE.MeshLambertMaterial({color:2236962}),n=new THREE.Mesh(e,r);n.position.y=-45,n.position.z=-8,n.receiveShadow=!0,n.castShadow=!0,scene.add(n),controls=new THREE.OrbitControls(camera),controls.damping=.2,controls.addEventListener("change",render),camera.lookAt(new THREE.Vector3(0,50,0)),controls.target=new THREE.Vector3(0,50,0);var o=new THREE.AmbientLight(3156547);scene.add(o);var t=new THREE.DirectionalLight(16776166,.5);t.position.set(-1500,2500,1e3).multiplyScalar(1),scene.add(t),t.castShadow=!0,t.shadowMapWidth=1024,t.shadowMapHeight=1024;var a=70;t.shadowCameraLeft=-a,t.shadowCameraRight=a,t.shadowCameraTop=1.5*a,t.shadowCameraBottom=-a,t.shadowCameraFar=3500,renderer=new THREE.WebGLRenderer({antialias:!0,transparent:!0,alpha:!0}),renderer.setPixelRatio(window.devicePixelRatio),renderer.setSize(SCREEN_WIDTH,SCREEN_HEIGHT),renderer.domElement.style.position="relative",container.appendChild(renderer.domElement),renderer.gammaInput=!0,renderer.gammaOutput=!0,renderer.shadowMapEnabled=!0;var s=document.createElement("img");s.crossOrigin="anonymous",s.src="https://crossorigin.me/https://s3-us-west-2.amazonaws.com/s.cdpn.io/61062/eye.jpg";var c=new THREE.Texture(s);c.needsUpdate=!0;var m=new THREE.JSONLoader(!0);m.load("https://s3-us-west-2.amazonaws.com/s.cdpn.io/61062/head.json",function(e){mesh=new THREE.Mesh(e,new THREE.MeshPhongMaterial({color:16580606,morphTargets:!0,overdraw:1,shading:THREE.FlatShading,side:THREE.DoubleSide})),mesh.scale.set(10,10,10),mesh.receiveShadow=!0,mesh.castShadow=!0,mesh.position.y=0,scene.add(mesh),animation=new THREE.MorphAnimation(mesh);var r=new THREE.SphereGeometry(6,32,32),n=new THREE.MeshLambertMaterial({color:16777215,map:c}),o=r.faceVertexUvs[0];for(i=0;i<o.length;i++)for(var t=o[i],a=r.faces[i],s=0;3>s;s++)t[s].x=.5*a.vertexNormals[s].x+.5,t[s].y=.5*a.vertexNormals[s].y+.5;eye_l=new THREE.Mesh(r,n),eye_l.position.set(-12.5,33,20),eye_l.update=function(e){this.rotation.copy(eye_driver.rotation)},scene.add(eye_l),eye_r=new THREE.Mesh(r,n),eye_r.update=function(e){this.rotation.copy(eye_driver.rotation)},eye_r.position.set(12.5,33,20),scene.add(eye_r),morph_logic=new Logic(mesh)}),window.addEventListener("resize",onWindowResize,!1)}function onWindowResize(){windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,camera.aspect=window.innerWidth/window.innerHeight,camera.updateProjectionMatrix(),renderer.setSize(window.innerWidth,window.innerHeight)}function ensureLoop(e){for(var r=0;r<e.hierarchy.length;r++){var n=e.hierarchy[r],o=e.data.hierarchy[0],t=e.data.hierarchy[e.data.hierarchy.length-1];t.pos=o.pos,t.rot=o.rot,t.scl=o.scl}}function clicker(e){e.parent.ex_bool=!0,e.parent.children.forEach(function(e){explosion=new Explode(e)})}function animate(){requestAnimationFrame(animate),render()}function render(e){theta+=.1;var r=1*clock.getDelta();if("undefined"!=typeof animation){var n=Math.floor(e/interpolation)+animOffset;morph_logic.loop_all_morphs(e);var e=Date.now();prevTime=e}var o=200,t=2;(camera.position.x<-o||camera.position.x>o)&&(camera.move_direction*=-1),camera.position.x+=t*camera.move_direction,camera.position.y+=t*camera.move_direction,camera.lookAt(new THREE.Vector3(0,20,0)),"undefined"!=typeof morph_logic&&(eye_l.rotation.copy(camera.rotation),eye_r.rotation.copy(camera.rotation)),renderer.render(scene,camera)}function Logic(e){this.ready=!0,this.reset_all_morphs=function(){for(var r=0;r<e.morphTargetInfluences.length;r++)e.morphTargetInfluences[r]=0};var r=0;this.counter=0;var n=["default","eye_l","mouth_open","char_m","char_u","laugh"];this.set_specific_morph=function(r,n){var o=.01;switch(r){case"default":this.reset_all_morphs(),e.morphTargetInfluences[0]=n*o;break;case"eye_l":this.reset_all_morphs(),e.morphTargetInfluences[1]=n*o;break;case"mouth_open":this.reset_all_morphs(),e.morphTargetInfluences[2]=n*o;break;case"char_m":this.reset_all_morphs(),e.morphTargetInfluences[3]=n*o;break;case"char_u":this.reset_all_morphs(),e.morphTargetInfluences[4]=n*o;break;case"laugh":this.reset_all_morphs(),e.morphTargetInfluences[5]=n*o}},this.direction=1,this.loop_all_morphs=function(e){this.counter%100==0&&(this.direction*=-1),this.counter<=0&&(this.direction*=-1,r<n.length?r++:r=0),this.set_specific_morph(n[r],this.counter),this.counter+=4*this.direction}}function onDocumentMouseDown(e){å.mouse.x=e.clientX/window.innerWidth*2-1,å.mouse.y=2*-(e.clientY/window.innerHeight)+1;var r=new THREE.Vector3(å.mouse.x,å.mouse.y,1);r.unproject(camera);var n=new THREE.Raycaster(camera.position,r.sub(camera.position).normalize()),o=n.intersectObjects(å.targetList);o.length>0&&clicker(o[0].object)}function onDocumentMouseMove(e){å.mouse.x=e.clientX/window.innerWidth*2-1,å.mouse.y=2*-(e.clientY/window.innerHeight)+1;var r=new THREE.Vector3(å.mouse.x,å.mouse.y,1);r.unproject(camera);var n=new THREE.Raycaster(camera.position,r.sub(camera.position).normalize()),o=n.intersectObjects(å.targetList);o.length>0&&mover(o[0].object),"undefined"!=typeof morph_logic&&morph_logic.loop_all_morphs(time)}var SCREEN_WIDTH=window.innerWidth,SCREEN_HEIGHT=window.innerHeight,FLOOR=-250,container,stats,camera,scene,renderer,time=0,mesh,helper,raycaster=new THREE.Raycaster,morph_logic,å={mouse:{x:0,y:0,z:.5},targetList:[]},controls,eye_driver,eye_l,eye_r,mouseX=0,mouseY=0,windowHalfX=window.innerWidth/2,windowHalfY=window.innerHeight/2,clock=new THREE.Clock;init(),animate();var radius=600,theta=0,prevTime=Date.now(),duration=5e3,keyframes=150,interpolation=duration/keyframes,currentKeyframe=0,lastKeyframe=0,animOffset=1;document.addEventListener("mousedown",onDocumentMouseDown,!1),document.addEventListener("mousemove",onDocumentMouseMove,!1);