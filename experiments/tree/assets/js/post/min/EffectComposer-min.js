THREE.EffectComposer=function(e,r){this.renderer=e,this.renderTarget1=r,void 0===this.renderTarget1&&(this.renderTargetParameters={minFilter:THREE.LinearFilter,magFilter:THREE.LinearFilter,format:THREE.RGBFormat,stencilBuffer:!1},this.renderTarget1=new THREE.WebGLRenderTarget(window.innerWidth,window.innerHeight,this.renderTargetParameters)),this.renderTarget2=this.renderTarget1.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.passes=[],this.copyPass=new THREE.ShaderPass(THREE.ShaderExtras.screen)},THREE.EffectComposer.prototype={swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e)},render:function(e){this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2;var r=!1,t,i,n=this.passes.length;for(i=0;n>i;i++)if(t=this.passes[i],t.enabled){if(t.render(this.renderer,this.writeBuffer,this.readBuffer,e,r),t.needsSwap){if(r){var s=this.renderer.context;s.stencilFunc(s.NOTEQUAL,1,4294967295),this.copyPass.render(this.renderer,this.writeBuffer,this.readBuffer,e),s.stencilFunc(s.EQUAL,1,4294967295)}this.swapBuffers()}t instanceof THREE.MaskPass?r=!0:t instanceof THREE.ClearMaskPass&&(r=!1)}},reset:function(e){this.renderTarget1=e,void 0===this.renderTarget1&&(this.renderTarget1=new THREE.WebGLRenderTarget(window.innerWidth,window.innerHeight,this.renderTargetParameters)),this.renderTarget2=this.renderTarget1.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,THREE.EffectComposer.quad.scale.set(window.innerWidth,window.innerHeight,1),THREE.EffectComposer.camera.left=window.innerWidth/-2,THREE.EffectComposer.camera.right=window.innerWidth/2,THREE.EffectComposer.camera.top=window.innerHeight/2,THREE.EffectComposer.camera.bottom=window.innerHeight/-2,THREE.EffectComposer.camera.updateProjectionMatrix()}},THREE.EffectComposer.camera=new THREE.OrthographicCamera(window.innerWidth/-2,window.innerWidth/2,window.innerHeight/2,window.innerHeight/-2,-1e4,1e4),THREE.EffectComposer.geometry=new THREE.PlaneGeometry(1,1),THREE.EffectComposer.geometry.applyMatrix((new THREE.Matrix4).makeRotationX(Math.PI/2)),THREE.EffectComposer.quad=new THREE.Mesh(THREE.EffectComposer.geometry,null),THREE.EffectComposer.quad.position.z=-100,THREE.EffectComposer.quad.scale.set(window.innerWidth,window.innerHeight,1),THREE.EffectComposer.scene=new THREE.Scene,THREE.EffectComposer.scene.add(THREE.EffectComposer.quad),THREE.EffectComposer.scene.add(THREE.EffectComposer.camera);